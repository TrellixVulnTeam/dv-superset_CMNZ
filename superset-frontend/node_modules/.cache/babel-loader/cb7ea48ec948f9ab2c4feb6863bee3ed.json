{"ast":null,"code":"import \"core-js/modules/web.dom-collections.iterator.js\";import _extends from \"@babel/runtime-corejs3/helpers/extends\";import _includesInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/includes\";import _mapInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/map\";import _setTimeout from \"@babel/runtime-corejs3/core-js-stable/set-timeout\";import _filterInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/filter\";import _bindInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/bind\";import _indexOfInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/index-of\";var _jsxFileName = \"/Users/frankhe/projects/superset/superset-frontend/src/dashboard/components/gridComponents/Tabs.jsx\";(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { styled, t } from '@superset-ui/core';\nimport { connect } from 'react-redux';\nimport { LineEditableTabs } from 'src/components/Tabs';\nimport { LOG_ACTIONS_SELECT_DASHBOARD_TAB } from 'src/logger/LogUtils';\nimport { Modal } from 'src/common/components';\nimport DragDroppable from '../dnd/DragDroppable';\nimport DragHandle from '../dnd/DragHandle';\nimport DashboardComponent from '../../containers/DashboardComponent';\nimport DeleteComponentButton from '../DeleteComponentButton';\nimport HoverMenu from '../menu/HoverMenu';\nimport findTabIndexByComponentId from '../../util/findTabIndexByComponentId';\nimport getDirectPathToTabIndex from '../../util/getDirectPathToTabIndex';\nimport getLeafComponentIdFromPath from '../../util/getLeafComponentIdFromPath';\nimport { componentShape } from '../../util/propShapes';\nimport { NEW_TAB_ID, DASHBOARD_ROOT_ID } from '../../util/constants';\nimport { RENDER_TAB, RENDER_TAB_CONTENT } from './Tab';\nimport { TAB_TYPE } from '../../util/componentTypes';import { jsx as ___EmotionJSX } from \"@emotion/react\";\n\nconst propTypes = {\n  id: PropTypes.string.isRequired,\n  parentId: PropTypes.string.isRequired,\n  component: componentShape.isRequired,\n  parentComponent: componentShape.isRequired,\n  index: PropTypes.number.isRequired,\n  depth: PropTypes.number.isRequired,\n  renderTabContent: PropTypes.bool, // whether to render tabs + content or just tabs\n  editMode: PropTypes.bool.isRequired,\n  renderHoverMenu: PropTypes.bool,\n  directPathToChild: PropTypes.arrayOf(PropTypes.string),\n  activeTabs: PropTypes.arrayOf(PropTypes.string),\n\n  // actions (from DashboardComponent.jsx)\n  logEvent: PropTypes.func.isRequired,\n  setActiveTabs: PropTypes.func,\n\n  // grid related\n  availableColumnCount: PropTypes.number,\n  columnWidth: PropTypes.number,\n  onResizeStart: PropTypes.func,\n  onResize: PropTypes.func,\n  onResizeStop: PropTypes.func,\n\n  // dnd\n  createComponent: PropTypes.func.isRequired,\n  handleComponentDrop: PropTypes.func.isRequired,\n  onChangeTab: PropTypes.func.isRequired,\n  deleteComponent: PropTypes.func.isRequired,\n  updateComponents: PropTypes.func.isRequired };\n\n\nconst defaultProps = {\n  renderTabContent: true,\n  renderHoverMenu: true,\n  availableColumnCount: 0,\n  columnWidth: 0,\n  directPathToChild: [],\n  activeTabs: [],\n  setActiveTabs() {},\n  onResizeStart() {},\n  onResize() {},\n  onResizeStop() {} };\n\n\nconst StyledTabsContainer = styled.div`\n  width: 100%;\n  background-color: ${({ theme }) => theme.colors.grayscale.light5};\n\n  .dashboard-component-tabs-content {\n    min-height: ${({ theme }) => theme.gridUnit * 12}px;\n    margin-top: ${({ theme }) => theme.gridUnit / 4}px;\n    position: relative;\n  }\n\n  .ant-tabs {\n    overflow: visible;\n\n    .ant-tabs-nav-wrap {\n      min-height: ${({ theme }) => theme.gridUnit * 12.5}px;\n    }\n\n    .ant-tabs-content-holder {\n      overflow: visible;\n    }\n  }\n\n  div .ant-tabs-tab-btn {\n    text-transform: none;\n  }\n`;\n\nexport class Tabs extends React.PureComponent {\n  constructor(props) {var _context2, _context3, _context4, _context5;\n    super(props);this.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n    showDeleteConfirmModal = (key) => {\n      const { component, deleteComponent } = this.props;\n      Modal.confirm({\n        title: t('Delete dashboard tab?'),\n        content:\n        ___EmotionJSX(\"span\", { __self: this, __source: { fileName: _jsxFileName, lineNumber: 202, columnNumber: 9 } }, \"Deleting a tab will remove all content within it. You may still reverse this action with the \",\n\n        ___EmotionJSX(\"b\", { __self: this, __source: { fileName: _jsxFileName, lineNumber: 204, columnNumber: 40 } }, \"undo\"), \" button (cmd + z) until you save your changes.\"),\n\n\n\n        onOk: () => {var _context;\n          deleteComponent(key, component.id);\n          const tabIndex = _indexOfInstanceProperty(_context = component.children).call(_context, key);\n          this.handleDeleteTab(tabIndex);\n        },\n        okType: 'danger',\n        okText: 'DELETE',\n        cancelText: 'CANCEL',\n        icon: null });\n\n    };this.\n\n    handleEdit = (key, action) => {\n      const { component, createComponent } = this.props;\n      if (action === 'add') {\n        createComponent({\n          destination: {\n            id: component.id,\n            type: component.type,\n            index: component.children.length },\n\n          dragging: {\n            id: NEW_TAB_ID,\n            type: TAB_TYPE } });\n\n\n      } else if (action === 'remove') {\n        this.showDeleteConfirmModal(key);\n      }\n    };const _tabIndex = Math.max(0, findTabIndexByComponentId({ currentComponent: props.component, directPathToChild: props.directPathToChild }));const { children: tabIds } = props.component;const activeKey = tabIds[_tabIndex];this.state = { tabIndex: _tabIndex, activeKey };this.handleClickTab = _bindInstanceProperty(_context2 = this.handleClickTab).call(_context2, this);this.handleDeleteComponent = _bindInstanceProperty(_context3 = this.handleDeleteComponent).call(_context3, this);this.handleDeleteTab = _bindInstanceProperty(_context4 = this.handleDeleteTab).call(_context4, this);this.handleDropOnTab = _bindInstanceProperty(_context5 = this.handleDropOnTab).call(_context5, this);}componentDidMount() {this.props.setActiveTabs([...this.props.activeTabs, this.state.activeKey]);}componentDidUpdate(prevProps, prevState) {if (prevState.activeKey !== this.state.activeKey) {var _context6;this.props.setActiveTabs([..._filterInstanceProperty(_context6 = this.props.activeTabs).call(_context6, (tabId) => tabId !== prevState.activeKey), this.state.activeKey]);}}UNSAFE_componentWillReceiveProps(nextProps) {const maxIndex = Math.max(0, nextProps.component.children.length - 1);const currTabsIds = this.props.component.children;const nextTabsIds = nextProps.component.children;if (this.state.tabIndex > maxIndex) {this.setState(() => ({ tabIndex: maxIndex }));}if (nextTabsIds.length) {const lastTabId = nextTabsIds[nextTabsIds.length - 1]; // if a new tab is added focus on it immediately\n      if (nextTabsIds.length > currTabsIds.length) {// a new tab's path may be empty, here also need to set tabIndex\n        this.setState(() => ({ activeKey: lastTabId, tabIndex: maxIndex }));} // if a tab is removed focus on the first\n      if (nextTabsIds.length < currTabsIds.length) {this.setState(() => ({ activeKey: nextTabsIds[0] }));}}if (nextProps.isComponentVisible) {const nextFocusComponent = getLeafComponentIdFromPath(nextProps.directPathToChild);const currentFocusComponent = getLeafComponentIdFromPath(this.props.directPathToChild);if (nextFocusComponent !== currentFocusComponent) {const nextTabIndex = findTabIndexByComponentId({ currentComponent: nextProps.component, directPathToChild: nextProps.directPathToChild }); // make sure nextFocusComponent is under this tabs component\n        if (nextTabIndex > -1 && nextTabIndex !== this.state.tabIndex) {this.setState(() => ({ tabIndex: nextTabIndex, activeKey: nextTabsIds[nextTabIndex] }));}}}}handleClickTab(tabIndex) {const { component } = this.props;const { children: tabIds } = component;\n\n    if (tabIndex !== this.state.tabIndex) {\n      const pathToTabIndex = getDirectPathToTabIndex(component, tabIndex);\n      const targetTabId = pathToTabIndex[pathToTabIndex.length - 1];\n      this.props.logEvent(LOG_ACTIONS_SELECT_DASHBOARD_TAB, {\n        target_id: targetTabId,\n        index: tabIndex });\n\n\n      this.props.onChangeTab({ pathToTabIndex });\n    }\n    this.setState(() => ({ activeKey: tabIds[tabIndex] }));\n  }\n\n  handleDeleteComponent() {\n    const { deleteComponent, id, parentId } = this.props;\n    deleteComponent(id, parentId);\n  }\n\n  handleDeleteTab(tabIndex) {\n    this.handleClickTab(Math.max(0, tabIndex - 1));\n  }\n\n  handleDropOnTab(dropResult) {\n    const { component } = this.props;\n\n    // Ensure dropped tab is visible\n    const { destination } = dropResult;\n    if (destination) {var _context7;\n      const dropTabIndex =\n      destination.id === component.id ?\n      destination.index // dropped ON tabs\n      : _indexOfInstanceProperty(_context7 = component.children).call(_context7, destination.id); // dropped IN tab\n\n      if (dropTabIndex > -1) {\n        _setTimeout(() => {\n          this.handleClickTab(dropTabIndex);\n        }, 30);\n      }\n    }\n  }\n\n  render() {\n    const {\n      depth,\n      component: tabsComponent,\n      parentComponent,\n      index,\n      availableColumnCount,\n      columnWidth,\n      onResizeStart,\n      onResize,\n      onResizeStop,\n      handleComponentDrop,\n      renderTabContent,\n      renderHoverMenu,\n      isComponentVisible: isCurrentTabVisible,\n      editMode,\n      nativeFilters } =\n    this.props;\n\n    const { children: tabIds } = tabsComponent;\n    const { tabIndex: selectedTabIndex, activeKey } = this.state;\n\n    let tabsToHighlight;\n    if (nativeFilters != null && nativeFilters.focusedFilterId) {\n      tabsToHighlight =\n      nativeFilters.filters[nativeFilters.focusedFilterId].tabsInScope;\n    }\n    return (\n      ___EmotionJSX(DragDroppable, {\n        component: tabsComponent,\n        parentComponent: parentComponent,\n        orientation: \"row\",\n        index: index,\n        depth: depth,\n        onDrop: handleComponentDrop,\n        editMode: editMode, __self: this, __source: { fileName: _jsxFileName, lineNumber: 312, columnNumber: 7 } },\n\n      ({\n        dropIndicatorProps: tabsDropIndicatorProps,\n        dragSourceRef: tabsDragSourceRef }) =>\n\n      ___EmotionJSX(StyledTabsContainer, {\n        className: \"dashboard-component dashboard-component-tabs\",\n        \"data-test\": \"dashboard-component-tabs\", __self: this, __source: { fileName: _jsxFileName, lineNumber: 325, columnNumber: 11 } },\n\n      editMode && renderHoverMenu &&\n      ___EmotionJSX(HoverMenu, { innerRef: tabsDragSourceRef, position: \"left\", __self: this, __source: { fileName: _jsxFileName, lineNumber: 330, columnNumber: 15 } },\n      ___EmotionJSX(DragHandle, { position: \"left\", __self: this, __source: { fileName: _jsxFileName, lineNumber: 331, columnNumber: 17 } }),\n      ___EmotionJSX(DeleteComponentButton, { onDelete: this.handleDeleteComponent, __self: this, __source: { fileName: _jsxFileName, lineNumber: 332, columnNumber: 17 } })),\n\n\n\n      ___EmotionJSX(LineEditableTabs, {\n        id: tabsComponent.id,\n        activeKey: activeKey,\n        onChange: (key) => {\n          this.handleClickTab(_indexOfInstanceProperty(tabIds).call(tabIds, key));\n        },\n        onEdit: this.handleEdit,\n        \"data-test\": \"nav-list\",\n        type: editMode ? 'editable-card' : 'card', __self: this, __source: { fileName: _jsxFileName, lineNumber: 336, columnNumber: 13 } },\n\n      _mapInstanceProperty(tabIds).call(tabIds, (tabId, tabIndex) => {var _tabsToHighlight;return (\n          ___EmotionJSX(LineEditableTabs.TabPane, {\n            key: tabId,\n            tab:\n            ___EmotionJSX(DashboardComponent, {\n              id: tabId,\n              parentId: tabsComponent.id,\n              depth: depth,\n              index: tabIndex,\n              renderType: RENDER_TAB,\n              availableColumnCount: availableColumnCount,\n              columnWidth: columnWidth,\n              onDropOnTab: this.handleDropOnTab,\n              isFocused: activeKey === tabId,\n              isHighlighted:\n              activeKey !== tabId && ((_tabsToHighlight = tabsToHighlight) == null ? void 0 : _includesInstanceProperty(_tabsToHighlight).call(_tabsToHighlight, tabId)), __self: this, __source: { fileName: _jsxFileName, lineNumber: 350, columnNumber: 21 } }), __self: this, __source: { fileName: _jsxFileName, lineNumber: 347, columnNumber: 17 } },\n\n\n\n\n          renderTabContent &&\n          ___EmotionJSX(DashboardComponent, {\n            id: tabId,\n            parentId: tabsComponent.id,\n            depth: depth // see isValidChild.js for why tabs don't increment child depth\n            , index: tabIndex,\n            renderType: RENDER_TAB_CONTENT,\n            availableColumnCount: availableColumnCount,\n            columnWidth: columnWidth,\n            onResizeStart: onResizeStart,\n            onResize: onResize,\n            onResizeStop: onResizeStop,\n            onDropOnTab: this.handleDropOnTab,\n            isComponentVisible:\n            selectedTabIndex === tabIndex && isCurrentTabVisible, __self: this, __source: { fileName: _jsxFileName, lineNumber: 367, columnNumber: 21 } })));})),\n\n\n\n\n\n\n\n\n      tabsDropIndicatorProps &&\n      parentComponent.id !== DASHBOARD_ROOT_ID &&\n      ___EmotionJSX(\"div\", _extends({}, tabsDropIndicatorProps, { __self: this, __source: { fileName: _jsxFileName, lineNumber: 391, columnNumber: 17 } })))));\n\n\n\n\n\n  } // @ts-ignore\n  __reactstandin__regenerateByEval(key, code) {// @ts-ignore\n    this[key] = eval(code);}}\nTabs.propTypes = propTypes;\nTabs.defaultProps = defaultProps;\n\nfunction mapStateToProps(state) {\n  return { nativeFilters: state.nativeFilters };\n}const _default =\nconnect(mapStateToProps)(Tabs);export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(propTypes, \"propTypes\", \"/Users/frankhe/projects/superset/superset-frontend/src/dashboard/components/gridComponents/Tabs.jsx\");reactHotLoader.register(defaultProps, \"defaultProps\", \"/Users/frankhe/projects/superset/superset-frontend/src/dashboard/components/gridComponents/Tabs.jsx\");reactHotLoader.register(StyledTabsContainer, \"StyledTabsContainer\", \"/Users/frankhe/projects/superset/superset-frontend/src/dashboard/components/gridComponents/Tabs.jsx\");reactHotLoader.register(Tabs, \"Tabs\", \"/Users/frankhe/projects/superset/superset-frontend/src/dashboard/components/gridComponents/Tabs.jsx\");reactHotLoader.register(mapStateToProps, \"mapStateToProps\", \"/Users/frankhe/projects/superset/superset-frontend/src/dashboard/components/gridComponents/Tabs.jsx\");reactHotLoader.register(_default, \"default\", \"/Users/frankhe/projects/superset/superset-frontend/src/dashboard/components/gridComponents/Tabs.jsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"sources":["/Users/frankhe/projects/superset/superset-frontend/src/dashboard/components/gridComponents/Tabs.jsx"],"names":["React","PropTypes","styled","t","connect","LineEditableTabs","LOG_ACTIONS_SELECT_DASHBOARD_TAB","Modal","DragDroppable","DragHandle","DashboardComponent","DeleteComponentButton","HoverMenu","findTabIndexByComponentId","getDirectPathToTabIndex","getLeafComponentIdFromPath","componentShape","NEW_TAB_ID","DASHBOARD_ROOT_ID","RENDER_TAB","RENDER_TAB_CONTENT","TAB_TYPE","propTypes","id","string","isRequired","parentId","component","parentComponent","index","number","depth","renderTabContent","bool","editMode","renderHoverMenu","directPathToChild","arrayOf","activeTabs","logEvent","func","setActiveTabs","availableColumnCount","columnWidth","onResizeStart","onResize","onResizeStop","createComponent","handleComponentDrop","onChangeTab","deleteComponent","updateComponents","defaultProps","StyledTabsContainer","div","theme","colors","grayscale","light5","gridUnit","Tabs","PureComponent","constructor","props","showDeleteConfirmModal","key","confirm","title","content","onOk","tabIndex","children","handleDeleteTab","okType","okText","cancelText","icon","handleEdit","action","destination","type","length","dragging","Math","max","currentComponent","tabIds","activeKey","state","handleClickTab","handleDeleteComponent","handleDropOnTab","componentDidMount","componentDidUpdate","prevProps","prevState","tabId","UNSAFE_componentWillReceiveProps","nextProps","maxIndex","currTabsIds","nextTabsIds","setState","lastTabId","isComponentVisible","nextFocusComponent","currentFocusComponent","nextTabIndex","pathToTabIndex","targetTabId","target_id","dropResult","dropTabIndex","render","tabsComponent","isCurrentTabVisible","nativeFilters","selectedTabIndex","tabsToHighlight","focusedFilterId","filters","tabsInScope","dropIndicatorProps","tabsDropIndicatorProps","dragSourceRef","tabsDragSourceRef","mapStateToProps"],"mappings":"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","sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { styled, t } from '@superset-ui/core';\nimport { connect } from 'react-redux';\nimport { LineEditableTabs } from 'src/components/Tabs';\nimport { LOG_ACTIONS_SELECT_DASHBOARD_TAB } from 'src/logger/LogUtils';\nimport { Modal } from 'src/common/components';\nimport DragDroppable from '../dnd/DragDroppable';\nimport DragHandle from '../dnd/DragHandle';\nimport DashboardComponent from '../../containers/DashboardComponent';\nimport DeleteComponentButton from '../DeleteComponentButton';\nimport HoverMenu from '../menu/HoverMenu';\nimport findTabIndexByComponentId from '../../util/findTabIndexByComponentId';\nimport getDirectPathToTabIndex from '../../util/getDirectPathToTabIndex';\nimport getLeafComponentIdFromPath from '../../util/getLeafComponentIdFromPath';\nimport { componentShape } from '../../util/propShapes';\nimport { NEW_TAB_ID, DASHBOARD_ROOT_ID } from '../../util/constants';\nimport { RENDER_TAB, RENDER_TAB_CONTENT } from './Tab';\nimport { TAB_TYPE } from '../../util/componentTypes';\n\nconst propTypes = {\n  id: PropTypes.string.isRequired,\n  parentId: PropTypes.string.isRequired,\n  component: componentShape.isRequired,\n  parentComponent: componentShape.isRequired,\n  index: PropTypes.number.isRequired,\n  depth: PropTypes.number.isRequired,\n  renderTabContent: PropTypes.bool, // whether to render tabs + content or just tabs\n  editMode: PropTypes.bool.isRequired,\n  renderHoverMenu: PropTypes.bool,\n  directPathToChild: PropTypes.arrayOf(PropTypes.string),\n  activeTabs: PropTypes.arrayOf(PropTypes.string),\n\n  // actions (from DashboardComponent.jsx)\n  logEvent: PropTypes.func.isRequired,\n  setActiveTabs: PropTypes.func,\n\n  // grid related\n  availableColumnCount: PropTypes.number,\n  columnWidth: PropTypes.number,\n  onResizeStart: PropTypes.func,\n  onResize: PropTypes.func,\n  onResizeStop: PropTypes.func,\n\n  // dnd\n  createComponent: PropTypes.func.isRequired,\n  handleComponentDrop: PropTypes.func.isRequired,\n  onChangeTab: PropTypes.func.isRequired,\n  deleteComponent: PropTypes.func.isRequired,\n  updateComponents: PropTypes.func.isRequired,\n};\n\nconst defaultProps = {\n  renderTabContent: true,\n  renderHoverMenu: true,\n  availableColumnCount: 0,\n  columnWidth: 0,\n  directPathToChild: [],\n  activeTabs: [],\n  setActiveTabs() {},\n  onResizeStart() {},\n  onResize() {},\n  onResizeStop() {},\n};\n\nconst StyledTabsContainer = styled.div`\n  width: 100%;\n  background-color: ${({ theme }) => theme.colors.grayscale.light5};\n\n  .dashboard-component-tabs-content {\n    min-height: ${({ theme }) => theme.gridUnit * 12}px;\n    margin-top: ${({ theme }) => theme.gridUnit / 4}px;\n    position: relative;\n  }\n\n  .ant-tabs {\n    overflow: visible;\n\n    .ant-tabs-nav-wrap {\n      min-height: ${({ theme }) => theme.gridUnit * 12.5}px;\n    }\n\n    .ant-tabs-content-holder {\n      overflow: visible;\n    }\n  }\n\n  div .ant-tabs-tab-btn {\n    text-transform: none;\n  }\n`;\n\nexport class Tabs extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    const tabIndex = Math.max(\n      0,\n      findTabIndexByComponentId({\n        currentComponent: props.component,\n        directPathToChild: props.directPathToChild,\n      }),\n    );\n    const { children: tabIds } = props.component;\n    const activeKey = tabIds[tabIndex];\n\n    this.state = {\n      tabIndex,\n      activeKey,\n    };\n    this.handleClickTab = this.handleClickTab.bind(this);\n    this.handleDeleteComponent = this.handleDeleteComponent.bind(this);\n    this.handleDeleteTab = this.handleDeleteTab.bind(this);\n    this.handleDropOnTab = this.handleDropOnTab.bind(this);\n  }\n\n  componentDidMount() {\n    this.props.setActiveTabs([...this.props.activeTabs, this.state.activeKey]);\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (prevState.activeKey !== this.state.activeKey) {\n      this.props.setActiveTabs([\n        ...this.props.activeTabs.filter(tabId => tabId !== prevState.activeKey),\n        this.state.activeKey,\n      ]);\n    }\n  }\n\n  UNSAFE_componentWillReceiveProps(nextProps) {\n    const maxIndex = Math.max(0, nextProps.component.children.length - 1);\n    const currTabsIds = this.props.component.children;\n    const nextTabsIds = nextProps.component.children;\n\n    if (this.state.tabIndex > maxIndex) {\n      this.setState(() => ({ tabIndex: maxIndex }));\n    }\n\n    if (nextTabsIds.length) {\n      const lastTabId = nextTabsIds[nextTabsIds.length - 1];\n      // if a new tab is added focus on it immediately\n      if (nextTabsIds.length > currTabsIds.length) {\n        // a new tab's path may be empty, here also need to set tabIndex\n        this.setState(() => ({\n          activeKey: lastTabId,\n          tabIndex: maxIndex,\n        }));\n      }\n      // if a tab is removed focus on the first\n      if (nextTabsIds.length < currTabsIds.length) {\n        this.setState(() => ({ activeKey: nextTabsIds[0] }));\n      }\n    }\n\n    if (nextProps.isComponentVisible) {\n      const nextFocusComponent = getLeafComponentIdFromPath(\n        nextProps.directPathToChild,\n      );\n      const currentFocusComponent = getLeafComponentIdFromPath(\n        this.props.directPathToChild,\n      );\n\n      if (nextFocusComponent !== currentFocusComponent) {\n        const nextTabIndex = findTabIndexByComponentId({\n          currentComponent: nextProps.component,\n          directPathToChild: nextProps.directPathToChild,\n        });\n\n        // make sure nextFocusComponent is under this tabs component\n        if (nextTabIndex > -1 && nextTabIndex !== this.state.tabIndex) {\n          this.setState(() => ({\n            tabIndex: nextTabIndex,\n            activeKey: nextTabsIds[nextTabIndex],\n          }));\n        }\n      }\n    }\n  }\n\n  showDeleteConfirmModal = key => {\n    const { component, deleteComponent } = this.props;\n    Modal.confirm({\n      title: t('Delete dashboard tab?'),\n      content: (\n        <span>\n          Deleting a tab will remove all content within it. You may still\n          reverse this action with the <b>undo</b> button (cmd + z) until you\n          save your changes.\n        </span>\n      ),\n      onOk: () => {\n        deleteComponent(key, component.id);\n        const tabIndex = component.children.indexOf(key);\n        this.handleDeleteTab(tabIndex);\n      },\n      okType: 'danger',\n      okText: 'DELETE',\n      cancelText: 'CANCEL',\n      icon: null,\n    });\n  };\n\n  handleEdit = (key, action) => {\n    const { component, createComponent } = this.props;\n    if (action === 'add') {\n      createComponent({\n        destination: {\n          id: component.id,\n          type: component.type,\n          index: component.children.length,\n        },\n        dragging: {\n          id: NEW_TAB_ID,\n          type: TAB_TYPE,\n        },\n      });\n    } else if (action === 'remove') {\n      this.showDeleteConfirmModal(key);\n    }\n  };\n\n  handleClickTab(tabIndex) {\n    const { component } = this.props;\n    const { children: tabIds } = component;\n\n    if (tabIndex !== this.state.tabIndex) {\n      const pathToTabIndex = getDirectPathToTabIndex(component, tabIndex);\n      const targetTabId = pathToTabIndex[pathToTabIndex.length - 1];\n      this.props.logEvent(LOG_ACTIONS_SELECT_DASHBOARD_TAB, {\n        target_id: targetTabId,\n        index: tabIndex,\n      });\n\n      this.props.onChangeTab({ pathToTabIndex });\n    }\n    this.setState(() => ({ activeKey: tabIds[tabIndex] }));\n  }\n\n  handleDeleteComponent() {\n    const { deleteComponent, id, parentId } = this.props;\n    deleteComponent(id, parentId);\n  }\n\n  handleDeleteTab(tabIndex) {\n    this.handleClickTab(Math.max(0, tabIndex - 1));\n  }\n\n  handleDropOnTab(dropResult) {\n    const { component } = this.props;\n\n    // Ensure dropped tab is visible\n    const { destination } = dropResult;\n    if (destination) {\n      const dropTabIndex =\n        destination.id === component.id\n          ? destination.index // dropped ON tabs\n          : component.children.indexOf(destination.id); // dropped IN tab\n\n      if (dropTabIndex > -1) {\n        setTimeout(() => {\n          this.handleClickTab(dropTabIndex);\n        }, 30);\n      }\n    }\n  }\n\n  render() {\n    const {\n      depth,\n      component: tabsComponent,\n      parentComponent,\n      index,\n      availableColumnCount,\n      columnWidth,\n      onResizeStart,\n      onResize,\n      onResizeStop,\n      handleComponentDrop,\n      renderTabContent,\n      renderHoverMenu,\n      isComponentVisible: isCurrentTabVisible,\n      editMode,\n      nativeFilters,\n    } = this.props;\n\n    const { children: tabIds } = tabsComponent;\n    const { tabIndex: selectedTabIndex, activeKey } = this.state;\n\n    let tabsToHighlight;\n    if (nativeFilters?.focusedFilterId) {\n      tabsToHighlight =\n        nativeFilters.filters[nativeFilters.focusedFilterId].tabsInScope;\n    }\n    return (\n      <DragDroppable\n        component={tabsComponent}\n        parentComponent={parentComponent}\n        orientation=\"row\"\n        index={index}\n        depth={depth}\n        onDrop={handleComponentDrop}\n        editMode={editMode}\n      >\n        {({\n          dropIndicatorProps: tabsDropIndicatorProps,\n          dragSourceRef: tabsDragSourceRef,\n        }) => (\n          <StyledTabsContainer\n            className=\"dashboard-component dashboard-component-tabs\"\n            data-test=\"dashboard-component-tabs\"\n          >\n            {editMode && renderHoverMenu && (\n              <HoverMenu innerRef={tabsDragSourceRef} position=\"left\">\n                <DragHandle position=\"left\" />\n                <DeleteComponentButton onDelete={this.handleDeleteComponent} />\n              </HoverMenu>\n            )}\n\n            <LineEditableTabs\n              id={tabsComponent.id}\n              activeKey={activeKey}\n              onChange={key => {\n                this.handleClickTab(tabIds.indexOf(key));\n              }}\n              onEdit={this.handleEdit}\n              data-test=\"nav-list\"\n              type={editMode ? 'editable-card' : 'card'}\n            >\n              {tabIds.map((tabId, tabIndex) => (\n                <LineEditableTabs.TabPane\n                  key={tabId}\n                  tab={\n                    <DashboardComponent\n                      id={tabId}\n                      parentId={tabsComponent.id}\n                      depth={depth}\n                      index={tabIndex}\n                      renderType={RENDER_TAB}\n                      availableColumnCount={availableColumnCount}\n                      columnWidth={columnWidth}\n                      onDropOnTab={this.handleDropOnTab}\n                      isFocused={activeKey === tabId}\n                      isHighlighted={\n                        activeKey !== tabId && tabsToHighlight?.includes(tabId)\n                      }\n                    />\n                  }\n                >\n                  {renderTabContent && (\n                    <DashboardComponent\n                      id={tabId}\n                      parentId={tabsComponent.id}\n                      depth={depth} // see isValidChild.js for why tabs don't increment child depth\n                      index={tabIndex}\n                      renderType={RENDER_TAB_CONTENT}\n                      availableColumnCount={availableColumnCount}\n                      columnWidth={columnWidth}\n                      onResizeStart={onResizeStart}\n                      onResize={onResize}\n                      onResizeStop={onResizeStop}\n                      onDropOnTab={this.handleDropOnTab}\n                      isComponentVisible={\n                        selectedTabIndex === tabIndex && isCurrentTabVisible\n                      }\n                    />\n                  )}\n                </LineEditableTabs.TabPane>\n              ))}\n            </LineEditableTabs>\n\n            {/* don't indicate that a drop on root is allowed when tabs already exist */}\n            {tabsDropIndicatorProps &&\n              parentComponent.id !== DASHBOARD_ROOT_ID && (\n                <div {...tabsDropIndicatorProps} />\n              )}\n          </StyledTabsContainer>\n        )}\n      </DragDroppable>\n    );\n  }\n}\n\nTabs.propTypes = propTypes;\nTabs.defaultProps = defaultProps;\n\nfunction mapStateToProps(state) {\n  return { nativeFilters: state.nativeFilters };\n}\nexport default connect(mapStateToProps)(Tabs);\n"]},"metadata":{},"sourceType":"module"}