{"ast":null,"code":"import _filterInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/filter\";import _mapInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/map\";import _includesInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/includes\";import _forEachInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/for-each\";import _bindInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/bind\";var _jsxFileName = \"/Users/frankhe/projects/superset/superset-frontend/src/SqlLab/components/SqlEditorLeftBar.jsx\";(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport Button from 'src/components/Button';\nimport { t, styled, css } from '@superset-ui/core';\nimport Collapse from 'src/components/Collapse';\nimport Icons from 'src/components/Icons';\nimport TableElement from './TableElement';\nimport TableSelector from '../../components/TableSelector';\nimport { IconTooltip } from '../../components/IconTooltip';import { jsx as ___EmotionJSX } from \"@emotion/react\";\n\nconst propTypes = {\n  queryEditor: PropTypes.object.isRequired,\n  height: PropTypes.number,\n  tables: PropTypes.array,\n  actions: PropTypes.object,\n  database: PropTypes.object,\n  offline: PropTypes.bool };\n\n\nconst defaultProps = {\n  actions: {},\n  height: 500,\n  offline: false,\n  tables: [] };\n\n\nconst StyledScrollbarContainer = styled.div`\n  flex: 1 1 auto;\n  overflow: auto;\n`;\n\nconst StyledScrollbarContent = styled.div`\n  height: ${(props) => props.contentHeight}px;\n`;\n\nexport default class SqlEditorLeftBar extends React.PureComponent {\n  constructor(props) {var _context, _context2, _context3, _context4, _context5, _context6, _context7, _context8;\n    super(props);this.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n    renderExpandIconWithTooltip = ({ isActive }) =>\n    ___EmotionJSX(IconTooltip, {\n      css: css`\n        transform: rotate(90deg);\n      `,\n      \"aria-label\": \"Collapse\",\n      tooltip: t(`${isActive ? 'Collapse' : 'Expand'} table preview`), __self: this, __source: { fileName: _jsxFileName, lineNumber: 140, columnNumber: 5 } },\n\n    ___EmotionJSX(Icons.RightOutlined, {\n      iconSize: \"s\",\n      css: css`\n          transform: ${isActive ? 'rotateY(180deg)' : ''};\n        `, __self: this, __source: { fileName: _jsxFileName, lineNumber: 147, columnNumber: 7 } }));this.resetState = _bindInstanceProperty(_context = this.resetState).call(_context, this);this.onSchemaChange = _bindInstanceProperty(_context2 = this.onSchemaChange).call(_context2, this);this.onSchemasLoad = _bindInstanceProperty(_context3 = this.onSchemasLoad).call(_context3, this);this.onTablesLoad = _bindInstanceProperty(_context4 = this.onTablesLoad).call(_context4, this);this.onDbChange = _bindInstanceProperty(_context5 = this.onDbChange).call(_context5, this);this.getDbList = _bindInstanceProperty(_context6 = this.getDbList).call(_context6, this);this.onTableChange = _bindInstanceProperty(_context7 = this.onTableChange).call(_context7, this);this.onToggleTable = _bindInstanceProperty(_context8 = this.onToggleTable).call(_context8, this);}onSchemaChange(schema) {this.props.actions.queryEditorSetSchema(this.props.queryEditor, schema);}onSchemasLoad(schemas) {this.props.actions.queryEditorSetSchemaOptions(this.props.queryEditor, schemas);}onTablesLoad(tables) {this.props.actions.queryEditorSetTableOptions(this.props.queryEditor, tables);}onDbChange(db) {this.props.actions.queryEditorSetDb(this.props.queryEditor, db.id);this.props.actions.queryEditorSetFunctionNames(this.props.queryEditor, db.id);}onTableChange(tableName, schemaName) {this.props.actions.addTable(this.props.queryEditor, tableName, schemaName);}onToggleTable(tables) {var _context9;_forEachInstanceProperty(_context9 = this.props.tables).call(_context9, (table) => {if (!_includesInstanceProperty(tables).call(tables, table.id.toString()) && table.expanded) {this.props.actions.collapseTable(table);} else if (_includesInstanceProperty(tables).call(tables, table.id.toString()) && !table.expanded) {this.props.actions.expandTable(table);}});}getDbList(dbs) {this.props.actions.setDatabases(dbs);}dbMutator(data) {var _context10;const options = _mapInstanceProperty(_context10 = data.result).call(_context10, (db) => ({ value: db.id, label: db.database_name }));this.props.actions.setDatabases(data.result);if (data.result.length === 0) {this.props.actions.addDangerToast(t(\"It seems you don't have access to any database\"));}return options;}resetState() {this.props.actions.resetState();}changeTable(tableOpt) {if (!tableOpt) {return;}const schemaName = tableOpt.value.schema;const tableName = tableOpt.value.table;this.props.actions.queryEditorSetSchema(this.props.queryEditor, schemaName);this.props.actions.addTable(this.props.queryEditor, tableName, schemaName);}\n\n\n\n\n  render() {var _context11, _context12, _context13;\n    const shouldShowReset = window.location.search === '?reset=1';\n    const tableMetaDataHeight = this.props.height - 130; // 130 is the height of the selects above\n    const qe = this.props.queryEditor;\n    return (\n      ___EmotionJSX(\"div\", { className: \"SqlEditorLeftBar\", __self: this, __source: { fileName: _jsxFileName, lineNumber: 161, columnNumber: 7 } },\n      ___EmotionJSX(TableSelector, {\n        database: this.props.database,\n        dbId: qe.dbId,\n        getDbList: this.getDbList,\n        handleError: this.props.actions.addDangerToast,\n        onDbChange: this.onDbChange,\n        onSchemaChange: this.onSchemaChange,\n        onSchemasLoad: this.onSchemasLoad,\n        onTableChange: this.onTableChange,\n        onTablesLoad: this.onTablesLoad,\n        schema: qe.schema,\n        sqlLabMode: true,\n        tableNameSticky: false, __self: this, __source: { fileName: _jsxFileName, lineNumber: 162, columnNumber: 9 } }),\n\n      ___EmotionJSX(\"div\", { className: \"divider\", __self: this, __source: { fileName: _jsxFileName, lineNumber: 176, columnNumber: 9 } }),\n      ___EmotionJSX(StyledScrollbarContainer, { __self: this, __source: { fileName: _jsxFileName, lineNumber: 177, columnNumber: 9 } },\n      ___EmotionJSX(StyledScrollbarContent, { contentHeight: tableMetaDataHeight, __self: this, __source: { fileName: _jsxFileName, lineNumber: 178, columnNumber: 11 } },\n      ___EmotionJSX(Collapse, {\n        activeKey: _mapInstanceProperty(_context11 = _filterInstanceProperty(_context12 = this.props.tables).call(_context12,\n        ({ expanded }) => expanded)).call(_context11,\n        ({ id }) => id),\n        css: (theme) => css`\n                .ant-collapse-item {\n                  margin-bottom: ${theme.gridUnit * 3}px;\n                }\n                .ant-collapse-header {\n                  padding: 0px !important;\n                  display: flex;\n                  align-items: center;\n                }\n                .ant-collapse-content-box {\n                  padding: 0px ${theme.gridUnit * 4}px 0px 0px !important;\n                }\n                .ant-collapse-arrow {\n                  top: ${theme.gridUnit * 2}px !important;\n                  color: ${theme.colors.primary.dark1} !important;\n                  &: hover {\n                    color: ${theme.colors.primary.dark2} !important;\n                  }\n                }\n              `,\n        expandIconPosition: \"right\",\n        ghost: true,\n        onChange: this.onToggleTable,\n        expandIcon: this.renderExpandIconWithTooltip, __self: this, __source: { fileName: _jsxFileName, lineNumber: 179, columnNumber: 13 } },\n\n      _mapInstanceProperty(_context13 = this.props.tables).call(_context13, (table) =>\n      ___EmotionJSX(TableElement, {\n        table: table,\n        key: table.id,\n        actions: this.props.actions, __self: this, __source: { fileName: _jsxFileName, lineNumber: 209, columnNumber: 17 } }))))),\n\n\n\n\n\n      shouldShowReset &&\n      ___EmotionJSX(Button, {\n        buttonSize: \"small\",\n        buttonStyle: \"danger\",\n        onClick: this.resetState, __self: this, __source: { fileName: _jsxFileName, lineNumber: 219, columnNumber: 11 } },\n\n      ___EmotionJSX(\"i\", { className: \"fa fa-bomb\", __self: this, __source: { fileName: _jsxFileName, lineNumber: 224, columnNumber: 13 } }), \" \", t('Reset state'))));\n\n\n\n\n  } // @ts-ignore\n  __reactstandin__regenerateByEval(key, code) {// @ts-ignore\n    this[key] = eval(code);}}\nSqlEditorLeftBar.propTypes = propTypes;\nSqlEditorLeftBar.defaultProps = defaultProps;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(propTypes, \"propTypes\", \"/Users/frankhe/projects/superset/superset-frontend/src/SqlLab/components/SqlEditorLeftBar.jsx\");reactHotLoader.register(defaultProps, \"defaultProps\", \"/Users/frankhe/projects/superset/superset-frontend/src/SqlLab/components/SqlEditorLeftBar.jsx\");reactHotLoader.register(StyledScrollbarContainer, \"StyledScrollbarContainer\", \"/Users/frankhe/projects/superset/superset-frontend/src/SqlLab/components/SqlEditorLeftBar.jsx\");reactHotLoader.register(StyledScrollbarContent, \"StyledScrollbarContent\", \"/Users/frankhe/projects/superset/superset-frontend/src/SqlLab/components/SqlEditorLeftBar.jsx\");reactHotLoader.register(SqlEditorLeftBar, \"SqlEditorLeftBar\", \"/Users/frankhe/projects/superset/superset-frontend/src/SqlLab/components/SqlEditorLeftBar.jsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"sources":["/Users/frankhe/projects/superset/superset-frontend/src/SqlLab/components/SqlEditorLeftBar.jsx"],"names":["React","PropTypes","Button","t","styled","css","Collapse","Icons","TableElement","TableSelector","IconTooltip","propTypes","queryEditor","object","isRequired","height","number","tables","array","actions","database","offline","bool","defaultProps","StyledScrollbarContainer","div","StyledScrollbarContent","props","contentHeight","SqlEditorLeftBar","PureComponent","constructor","renderExpandIconWithTooltip","isActive","resetState","onSchemaChange","onSchemasLoad","onTablesLoad","onDbChange","getDbList","onTableChange","onToggleTable","schema","queryEditorSetSchema","schemas","queryEditorSetSchemaOptions","queryEditorSetTableOptions","db","queryEditorSetDb","id","queryEditorSetFunctionNames","tableName","schemaName","addTable","table","toString","expanded","collapseTable","expandTable","dbs","setDatabases","dbMutator","data","options","result","value","label","database_name","length","addDangerToast","changeTable","tableOpt","render","shouldShowReset","window","location","search","tableMetaDataHeight","qe","dbId","theme","gridUnit","colors","primary","dark1","dark2"],"mappings":"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","sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport Button from 'src/components/Button';\nimport { t, styled, css } from '@superset-ui/core';\nimport Collapse from 'src/components/Collapse';\nimport Icons from 'src/components/Icons';\nimport TableElement from './TableElement';\nimport TableSelector from '../../components/TableSelector';\nimport { IconTooltip } from '../../components/IconTooltip';\n\nconst propTypes = {\n  queryEditor: PropTypes.object.isRequired,\n  height: PropTypes.number,\n  tables: PropTypes.array,\n  actions: PropTypes.object,\n  database: PropTypes.object,\n  offline: PropTypes.bool,\n};\n\nconst defaultProps = {\n  actions: {},\n  height: 500,\n  offline: false,\n  tables: [],\n};\n\nconst StyledScrollbarContainer = styled.div`\n  flex: 1 1 auto;\n  overflow: auto;\n`;\n\nconst StyledScrollbarContent = styled.div`\n  height: ${props => props.contentHeight}px;\n`;\n\nexport default class SqlEditorLeftBar extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.resetState = this.resetState.bind(this);\n    this.onSchemaChange = this.onSchemaChange.bind(this);\n    this.onSchemasLoad = this.onSchemasLoad.bind(this);\n    this.onTablesLoad = this.onTablesLoad.bind(this);\n    this.onDbChange = this.onDbChange.bind(this);\n    this.getDbList = this.getDbList.bind(this);\n    this.onTableChange = this.onTableChange.bind(this);\n    this.onToggleTable = this.onToggleTable.bind(this);\n  }\n\n  onSchemaChange(schema) {\n    this.props.actions.queryEditorSetSchema(this.props.queryEditor, schema);\n  }\n\n  onSchemasLoad(schemas) {\n    this.props.actions.queryEditorSetSchemaOptions(\n      this.props.queryEditor,\n      schemas,\n    );\n  }\n\n  onTablesLoad(tables) {\n    this.props.actions.queryEditorSetTableOptions(\n      this.props.queryEditor,\n      tables,\n    );\n  }\n\n  onDbChange(db) {\n    this.props.actions.queryEditorSetDb(this.props.queryEditor, db.id);\n    this.props.actions.queryEditorSetFunctionNames(\n      this.props.queryEditor,\n      db.id,\n    );\n  }\n\n  onTableChange(tableName, schemaName) {\n    this.props.actions.addTable(this.props.queryEditor, tableName, schemaName);\n  }\n\n  onToggleTable(tables) {\n    this.props.tables.forEach(table => {\n      if (!tables.includes(table.id.toString()) && table.expanded) {\n        this.props.actions.collapseTable(table);\n      } else if (tables.includes(table.id.toString()) && !table.expanded) {\n        this.props.actions.expandTable(table);\n      }\n    });\n  }\n\n  getDbList(dbs) {\n    this.props.actions.setDatabases(dbs);\n  }\n\n  dbMutator(data) {\n    const options = data.result.map(db => ({\n      value: db.id,\n      label: db.database_name,\n    }));\n    this.props.actions.setDatabases(data.result);\n    if (data.result.length === 0) {\n      this.props.actions.addDangerToast(\n        t(\"It seems you don't have access to any database\"),\n      );\n    }\n    return options;\n  }\n\n  resetState() {\n    this.props.actions.resetState();\n  }\n\n  changeTable(tableOpt) {\n    if (!tableOpt) {\n      return;\n    }\n    const schemaName = tableOpt.value.schema;\n    const tableName = tableOpt.value.table;\n    this.props.actions.queryEditorSetSchema(this.props.queryEditor, schemaName);\n    this.props.actions.addTable(this.props.queryEditor, tableName, schemaName);\n  }\n\n  renderExpandIconWithTooltip = ({ isActive }) => (\n    <IconTooltip\n      css={css`\n        transform: rotate(90deg);\n      `}\n      aria-label=\"Collapse\"\n      tooltip={t(`${isActive ? 'Collapse' : 'Expand'} table preview`)}\n    >\n      <Icons.RightOutlined\n        iconSize=\"s\"\n        css={css`\n          transform: ${isActive ? 'rotateY(180deg)' : ''};\n        `}\n      />\n    </IconTooltip>\n  );\n\n  render() {\n    const shouldShowReset = window.location.search === '?reset=1';\n    const tableMetaDataHeight = this.props.height - 130; // 130 is the height of the selects above\n    const qe = this.props.queryEditor;\n    return (\n      <div className=\"SqlEditorLeftBar\">\n        <TableSelector\n          database={this.props.database}\n          dbId={qe.dbId}\n          getDbList={this.getDbList}\n          handleError={this.props.actions.addDangerToast}\n          onDbChange={this.onDbChange}\n          onSchemaChange={this.onSchemaChange}\n          onSchemasLoad={this.onSchemasLoad}\n          onTableChange={this.onTableChange}\n          onTablesLoad={this.onTablesLoad}\n          schema={qe.schema}\n          sqlLabMode\n          tableNameSticky={false}\n        />\n        <div className=\"divider\" />\n        <StyledScrollbarContainer>\n          <StyledScrollbarContent contentHeight={tableMetaDataHeight}>\n            <Collapse\n              activeKey={this.props.tables\n                .filter(({ expanded }) => expanded)\n                .map(({ id }) => id)}\n              css={theme => css`\n                .ant-collapse-item {\n                  margin-bottom: ${theme.gridUnit * 3}px;\n                }\n                .ant-collapse-header {\n                  padding: 0px !important;\n                  display: flex;\n                  align-items: center;\n                }\n                .ant-collapse-content-box {\n                  padding: 0px ${theme.gridUnit * 4}px 0px 0px !important;\n                }\n                .ant-collapse-arrow {\n                  top: ${theme.gridUnit * 2}px !important;\n                  color: ${theme.colors.primary.dark1} !important;\n                  &: hover {\n                    color: ${theme.colors.primary.dark2} !important;\n                  }\n                }\n              `}\n              expandIconPosition=\"right\"\n              ghost\n              onChange={this.onToggleTable}\n              expandIcon={this.renderExpandIconWithTooltip}\n            >\n              {this.props.tables.map(table => (\n                <TableElement\n                  table={table}\n                  key={table.id}\n                  actions={this.props.actions}\n                />\n              ))}\n            </Collapse>\n          </StyledScrollbarContent>\n        </StyledScrollbarContainer>\n        {shouldShowReset && (\n          <Button\n            buttonSize=\"small\"\n            buttonStyle=\"danger\"\n            onClick={this.resetState}\n          >\n            <i className=\"fa fa-bomb\" /> {t('Reset state')}\n          </Button>\n        )}\n      </div>\n    );\n  }\n}\n\nSqlEditorLeftBar.propTypes = propTypes;\nSqlEditorLeftBar.defaultProps = defaultProps;\n"]},"metadata":{},"sourceType":"module"}