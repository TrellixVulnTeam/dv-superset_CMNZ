{"ast":null,"code":"import \"core-js/modules/web.dom-collections.iterator.js\";import _JSON$stringify from \"@babel/runtime-corejs3/core-js-stable/json/stringify\";import _sliceInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/slice\";import _mapInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/map\";import _Object$entries from \"@babel/runtime-corejs3/core-js-stable/object/entries\";import _forEachInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/for-each\";var _jsxFileName = \"/Users/frankhe/projects/superset/superset-frontend/src/SqlLab/components/ScheduleQueryButton.tsx\";(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();function _EMOTION_STRINGIFIED_CSS_ERROR__() {return \"You have tried to stringify object returned from `css` function. It isn't supposed to be used directly (e.g. as value of the `className` prop), but rather handed to emotion so it can handle it (e.g. as value of `css` prop).\";}var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useState } from 'react';\nimport SchemaForm from 'react-jsonschema-form';\nimport { Row, Col, Input, TextArea } from 'src/common/components';\nimport { t, styled } from '@superset-ui/core';\nimport * as chrono from 'chrono-node';\nimport ModalTrigger from 'src/components/ModalTrigger';\nimport { Form, FormItem } from 'src/components/Form';\nimport './ScheduleQueryButton.less';\nimport Button from 'src/components/Button';import { jsx as ___EmotionJSX } from \"@emotion/react\";\nconst validators = {\n  greater: (a, b) => a > b,\n  greater_equal: (a, b) => a >= b,\n  less: (a, b) => a < b,\n  less_equal: (a, b) => a <= b };\n\nconst getJSONSchema = () => {var _window$featureFlags$;\n  const jsonSchema = (_window$featureFlags$ = window.featureFlags.SCHEDULED_QUERIES) == null ? void 0 : _window$featureFlags$.JSONSCHEMA;\n  // parse date-time into usable value (eg, 'today' => `new Date()`)\n  if (jsonSchema) {var _context;\n    _forEachInstanceProperty(_context = _Object$entries(jsonSchema.properties)).call(_context, ([key, value]) => {\n      if (value.default && value.format === 'date-time') {\n        jsonSchema.properties[key] = {\n          ...value,\n          default: chrono.parseDate(value.default).toISOString() };\n\n      }\n    });\n    return jsonSchema;\n  }\n  return {};\n};\nconst getUISchema = () => {var _window$featureFlags$2;return (_window$featureFlags$2 = window.featureFlags.SCHEDULED_QUERIES) == null ? void 0 : _window$featureFlags$2.UISCHEMA;};\nconst getValidationRules = () => {var _window$featureFlags$3;return ((_window$featureFlags$3 = window.featureFlags.SCHEDULED_QUERIES) == null ? void 0 : _window$featureFlags$3.VALIDATION) || [];};\nconst getValidator = () => {\n  const rules = getValidationRules();\n  return (formData, errors) => {\n    _forEachInstanceProperty(rules).call(rules, (rule) => {var _context2, _context3;\n      const test = validators[rule.name];\n      const args = _mapInstanceProperty(_context2 = rule.arguments).call(_context2, (name) => formData[name]);\n      const container = rule.container || _sliceInstanceProperty(_context3 = rule.arguments).call(_context3, -1)[0];\n      if (!test(...args)) {\n        errors[container].addError(rule.message);\n      }\n    });\n    return errors;\n  };\n};\nconst StyledRow = styled(Row)`\n  padding-bottom: ${({ theme }) => theme.gridUnit * 2}px;\n`;\nexport const StyledButtonComponent = styled(Button)`\n  background: none;\n  text-transform: none;\n  padding: 0px;\n  color: rgba(0, 0, 0, 0.85);\n  font-size: 14px;\n  font-weight: ${({ theme }) => theme.typography.weights.normal};\n  &:disabled {\n    background: none;\n    color: rgba(0, 0, 0, 0.85);\n    &:hover {\n      background: none;\n      color: rgba(0, 0, 0, 0.85);\n    }\n  }\n`;var _ref = process.env.NODE_ENV === \"production\" ? { name: \"tjo4qw\", styles: \"float:right\" } : { name: \"nh75pi-renderModalBody\", styles: \"float:right;label:renderModalBody;\", map: \"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9mcmFua2hlL3Byb2plY3RzL3N1cGVyc2V0L3N1cGVyc2V0LWZyb250ZW5kL3NyYy9TcWxMYWIvY29tcG9uZW50cy9TY2hlZHVsZVF1ZXJ5QnV0dG9uLnRzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUF3SDhEIiwiZmlsZSI6Ii9Vc2Vycy9mcmFua2hlL3Byb2plY3RzL3N1cGVyc2V0L3N1cGVyc2V0LWZyb250ZW5kL3NyYy9TcWxMYWIvY29tcG9uZW50cy9TY2hlZHVsZVF1ZXJ5QnV0dG9uLnRzeCIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0aW9uIChBU0YpIHVuZGVyIG9uZVxuICogb3IgbW9yZSBjb250cmlidXRvciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlXG4gKiBkaXN0cmlidXRlZCB3aXRoIHRoaXMgd29yayBmb3IgYWRkaXRpb25hbCBpbmZvcm1hdGlvblxuICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZVxuICogdG8geW91IHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZVxuICogXCJMaWNlbnNlXCIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlXG4gKiB3aXRoIHRoZSBMaWNlbnNlLiAgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsXG4gKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhblxuICogXCJBUyBJU1wiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTllcbiAqIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuICBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZVxuICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZCBsaW1pdGF0aW9uc1xuICogdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmltcG9ydCBSZWFjdCwgeyB1c2VTdGF0ZSB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBTY2hlbWFGb3JtIGZyb20gJ3JlYWN0LWpzb25zY2hlbWEtZm9ybSc7XG5pbXBvcnQgeyBSb3csIENvbCwgSW5wdXQsIFRleHRBcmVhIH0gZnJvbSAnc3JjL2NvbW1vbi9jb21wb25lbnRzJztcbmltcG9ydCB7IHQsIHN0eWxlZCB9IGZyb20gJ0BzdXBlcnNldC11aS9jb3JlJztcbmltcG9ydCAqIGFzIGNocm9ubyBmcm9tICdjaHJvbm8tbm9kZSc7XG5pbXBvcnQgTW9kYWxUcmlnZ2VyIGZyb20gJ3NyYy9jb21wb25lbnRzL01vZGFsVHJpZ2dlcic7XG5pbXBvcnQgeyBGb3JtLCBGb3JtSXRlbSB9IGZyb20gJ3NyYy9jb21wb25lbnRzL0Zvcm0nO1xuaW1wb3J0ICcuL1NjaGVkdWxlUXVlcnlCdXR0b24ubGVzcyc7XG5pbXBvcnQgQnV0dG9uIGZyb20gJ3NyYy9jb21wb25lbnRzL0J1dHRvbic7XG5jb25zdCB2YWxpZGF0b3JzID0ge1xuICAgIGdyZWF0ZXI6IChhLCBiKSA9PiBhID4gYixcbiAgICBncmVhdGVyX2VxdWFsOiAoYSwgYikgPT4gYSA+PSBiLFxuICAgIGxlc3M6IChhLCBiKSA9PiBhIDwgYixcbiAgICBsZXNzX2VxdWFsOiAoYSwgYikgPT4gYSA8PSBiLFxufTtcbmNvbnN0IGdldEpTT05TY2hlbWEgPSAoKSA9PiB7XG4gICAgY29uc3QganNvblNjaGVtYSA9IHdpbmRvdy5mZWF0dXJlRmxhZ3MuU0NIRURVTEVEX1FVRVJJRVM/LkpTT05TQ0hFTUE7XG4gICAgLy8gcGFyc2UgZGF0ZS10aW1lIGludG8gdXNhYmxlIHZhbHVlIChlZywgJ3RvZGF5JyA9PiBgbmV3IERhdGUoKWApXG4gICAgaWYgKGpzb25TY2hlbWEpIHtcbiAgICAgICAgT2JqZWN0LmVudHJpZXMoanNvblNjaGVtYS5wcm9wZXJ0aWVzKS5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IHtcbiAgICAgICAgICAgIGlmICh2YWx1ZS5kZWZhdWx0ICYmIHZhbHVlLmZvcm1hdCA9PT0gJ2RhdGUtdGltZScpIHtcbiAgICAgICAgICAgICAgICBqc29uU2NoZW1hLnByb3BlcnRpZXNba2V5XSA9IHtcbiAgICAgICAgICAgICAgICAgICAgLi4udmFsdWUsXG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6IGNocm9uby5wYXJzZURhdGUodmFsdWUuZGVmYXVsdCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGpzb25TY2hlbWE7XG4gICAgfVxuICAgIHJldHVybiB7fTtcbn07XG5jb25zdCBnZXRVSVNjaGVtYSA9ICgpID0+IHdpbmRvdy5mZWF0dXJlRmxhZ3MuU0NIRURVTEVEX1FVRVJJRVM/LlVJU0NIRU1BO1xuY29uc3QgZ2V0VmFsaWRhdGlvblJ1bGVzID0gKCkgPT4gd2luZG93LmZlYXR1cmVGbGFncy5TQ0hFRFVMRURfUVVFUklFUz8uVkFMSURBVElPTiB8fCBbXTtcbmNvbnN0IGdldFZhbGlkYXRvciA9ICgpID0+IHtcbiAgICBjb25zdCBydWxlcyA9IGdldFZhbGlkYXRpb25SdWxlcygpO1xuICAgIHJldHVybiAoZm9ybURhdGEsIGVycm9ycykgPT4ge1xuICAgICAgICBydWxlcy5mb3JFYWNoKChydWxlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCB0ZXN0ID0gdmFsaWRhdG9yc1tydWxlLm5hbWVdO1xuICAgICAgICAgICAgY29uc3QgYXJncyA9IHJ1bGUuYXJndW1lbnRzLm1hcCgobmFtZSkgPT4gZm9ybURhdGFbbmFtZV0pO1xuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gcnVsZS5jb250YWluZXIgfHwgcnVsZS5hcmd1bWVudHMuc2xpY2UoLTEpWzBdO1xuICAgICAgICAgICAgaWYgKCF0ZXN0KC4uLmFyZ3MpKSB7XG4gICAgICAgICAgICAgICAgZXJyb3JzW2NvbnRhaW5lcl0uYWRkRXJyb3IocnVsZS5tZXNzYWdlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBlcnJvcnM7XG4gICAgfTtcbn07XG5jb25zdCBTdHlsZWRSb3cgPSBzdHlsZWQoUm93KSBgXG4gIHBhZGRpbmctYm90dG9tOiAkeyh7IHRoZW1lIH0pID0+IHRoZW1lLmdyaWRVbml0ICogMn1weDtcbmA7XG5leHBvcnQgY29uc3QgU3R5bGVkQnV0dG9uQ29tcG9uZW50ID0gc3R5bGVkKEJ1dHRvbikgYFxuICBiYWNrZ3JvdW5kOiBub25lO1xuICB0ZXh0LXRyYW5zZm9ybTogbm9uZTtcbiAgcGFkZGluZzogMHB4O1xuICBjb2xvcjogcmdiYSgwLCAwLCAwLCAwLjg1KTtcbiAgZm9udC1zaXplOiAxNHB4O1xuICBmb250LXdlaWdodDogJHsoeyB0aGVtZSB9KSA9PiB0aGVtZS50eXBvZ3JhcGh5LndlaWdodHMubm9ybWFsfTtcbiAgJjpkaXNhYmxlZCB7XG4gICAgYmFja2dyb3VuZDogbm9uZTtcbiAgICBjb2xvcjogcmdiYSgwLCAwLCAwLCAwLjg1KTtcbiAgICAmOmhvdmVyIHtcbiAgICAgIGJhY2tncm91bmQ6IG5vbmU7XG4gICAgICBjb2xvcjogcmdiYSgwLCAwLCAwLCAwLjg1KTtcbiAgICB9XG4gIH1cbmA7XG5jb25zdCBTY2hlZHVsZVF1ZXJ5QnV0dG9uID0gKHsgZGVmYXVsdExhYmVsID0gdCgnVW5kZWZpbmVkJyksIHNxbCwgc2NoZW1hLCBkYklkLCBvblNjaGVkdWxlID0gKCkgPT4geyB9LCBzY2hlZHVsZVF1ZXJ5V2FybmluZywgdG9vbHRpcCwgZGlzYWJsZWQgPSBmYWxzZSwgfSkgPT4ge1xuICAgIGNvbnN0IFtkZXNjcmlwdGlvbiwgc2V0RGVzY3JpcHRpb25dID0gdXNlU3RhdGUoJycpO1xuICAgIGNvbnN0IFtsYWJlbCwgc2V0TGFiZWxdID0gdXNlU3RhdGUoZGVmYXVsdExhYmVsKTtcbiAgICBjb25zdCBbc2hvd1NjaGVkdWxlLCBzZXRTaG93U2NoZWR1bGVdID0gdXNlU3RhdGUoZmFsc2UpO1xuICAgIGxldCBzYXZlTW9kYWw7XG4gICAgY29uc3Qgb25TY2hlZHVsZVN1Ym1pdCA9ICh7IGZvcm1EYXRhLCB9KSA9PiB7XG4gICAgICAgIGNvbnN0IHF1ZXJ5ID0ge1xuICAgICAgICAgICAgbGFiZWwsXG4gICAgICAgICAgICBkZXNjcmlwdGlvbixcbiAgICAgICAgICAgIGRiX2lkOiBkYklkLFxuICAgICAgICAgICAgc2NoZW1hLFxuICAgICAgICAgICAgc3FsLFxuICAgICAgICAgICAgZXh0cmFfanNvbjogSlNPTi5zdHJpbmdpZnkoeyBzY2hlZHVsZV9pbmZvOiBmb3JtRGF0YSB9KSxcbiAgICAgICAgfTtcbiAgICAgICAgb25TY2hlZHVsZShxdWVyeSk7XG4gICAgICAgIHNhdmVNb2RhbD8uY2xvc2UoKTtcbiAgICB9O1xuICAgIGNvbnN0IHJlbmRlck1vZGFsQm9keSA9ICgpID0+ICg8Rm9ybSBsYXlvdXQ9XCJ2ZXJ0aWNhbFwiPlxuICAgICAgPFN0eWxlZFJvdz5cbiAgICAgICAgPENvbCB4cz17MjR9PlxuICAgICAgICAgIDxGb3JtSXRlbSBsYWJlbD17dCgnTGFiZWwnKX0+XG4gICAgICAgICAgICA8SW5wdXQgdHlwZT1cInRleHRcIiBwbGFjZWhvbGRlcj17dCgnTGFiZWwgZm9yIHlvdXIgcXVlcnknKX0gdmFsdWU9e2xhYmVsfSBvbkNoYW5nZT17KGV2ZW50KSA9PiBzZXRMYWJlbChldmVudC50YXJnZXQudmFsdWUpfS8+XG4gICAgICAgICAgPC9Gb3JtSXRlbT5cbiAgICAgICAgPC9Db2w+XG4gICAgICA8L1N0eWxlZFJvdz5cbiAgICAgIDxTdHlsZWRSb3c+XG4gICAgICAgIDxDb2wgeHM9ezI0fT5cbiAgICAgICAgICA8Rm9ybUl0ZW0gbGFiZWw9e3QoJ0Rlc2NyaXB0aW9uJyl9PlxuICAgICAgICAgICAgPFRleHRBcmVhIHJvd3M9ezR9IHBsYWNlaG9sZGVyPXt0KCdXcml0ZSBhIGRlc2NyaXB0aW9uIGZvciB5b3VyIHF1ZXJ5Jyl9IHZhbHVlPXtkZXNjcmlwdGlvbn0gb25DaGFuZ2U9eyhldmVudCkgPT4gc2V0RGVzY3JpcHRpb24oZXZlbnQudGFyZ2V0LnZhbHVlKX0vPlxuICAgICAgICAgIDwvRm9ybUl0ZW0+XG4gICAgICAgIDwvQ29sPlxuICAgICAgPC9TdHlsZWRSb3c+XG4gICAgICA8Um93PlxuICAgICAgICA8Q29sIHhzPXsyNH0+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJqc29uLXNjaGVtYVwiPlxuICAgICAgICAgICAgPFNjaGVtYUZvcm0gc2NoZW1hPXtnZXRKU09OU2NoZW1hKCl9IHVpU2NoZW1hPXtnZXRVSVNjaGVtYX0gb25TdWJtaXQ9e29uU2NoZWR1bGVTdWJtaXR9IHZhbGlkYXRlPXtnZXRWYWxpZGF0b3IoKX0+XG4gICAgICAgICAgICAgIDxCdXR0b24gYnV0dG9uU3R5bGU9XCJwcmltYXJ5XCIgaHRtbFR5cGU9XCJzdWJtaXRcIiBjc3M9e3sgZmxvYXQ6ICdyaWdodCcgfX0+XG4gICAgICAgICAgICAgICAgU3VibWl0XG4gICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgPC9TY2hlbWFGb3JtPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L0NvbD5cbiAgICAgIDwvUm93PlxuICAgICAge3NjaGVkdWxlUXVlcnlXYXJuaW5nICYmICg8Um93PlxuICAgICAgICAgIDxDb2wgeHM9ezI0fT5cbiAgICAgICAgICAgIDxzbWFsbD57c2NoZWR1bGVRdWVyeVdhcm5pbmd9PC9zbWFsbD5cbiAgICAgICAgICA8L0NvbD5cbiAgICAgICAgPC9Sb3c+KX1cbiAgICA8L0Zvcm0+KTtcbiAgICByZXR1cm4gKDxzcGFuIGNsYXNzTmFtZT1cIlNjaGVkdWxlUXVlcnlCdXR0b25cIj5cbiAgICAgIDxNb2RhbFRyaWdnZXIgcmVmPXtyZWYgPT4ge1xuICAgICAgICAgICAgc2F2ZU1vZGFsID0gcmVmO1xuICAgICAgICB9fSBtb2RhbFRpdGxlPXt0KCdTY2hlZHVsZSBxdWVyeScpfSBtb2RhbEJvZHk9e3JlbmRlck1vZGFsQm9keSgpfSB0cmlnZ2VyTm9kZT17PFN0eWxlZEJ1dHRvbkNvbXBvbmVudCBvbkNsaWNrPXsoKSA9PiBzZXRTaG93U2NoZWR1bGUoIXNob3dTY2hlZHVsZSl9IGJ1dHRvblNpemU9XCJzbWFsbFwiIGJ1dHRvblN0eWxlPVwibGlua1wiIHRvb2x0aXA9e3Rvb2x0aXB9IGRpc2FibGVkPXtkaXNhYmxlZH0+XG4gICAgICAgICAgICB7dCgnU2NoZWR1bGUnKX1cbiAgICAgICAgICA8L1N0eWxlZEJ1dHRvbkNvbXBvbmVudD59Lz5cbiAgICA8L3NwYW4+KTtcbn07XG5leHBvcnQgZGVmYXVsdCBTY2hlZHVsZVF1ZXJ5QnV0dG9uO1xuIl19 */\", toString: _EMOTION_STRINGIFIED_CSS_ERROR__ };\nconst ScheduleQueryButton = ({ defaultLabel = t('Undefined'), sql, schema, dbId, onSchedule = () => {}, scheduleQueryWarning, tooltip, disabled = false }) => {\n  const [description, setDescription] = useState('');\n  const [label, setLabel] = useState(defaultLabel);\n  const [showSchedule, setShowSchedule] = useState(false);\n  let saveModal;\n  const onScheduleSubmit = ({ formData }) => {var _saveModal;\n    const query = {\n      label,\n      description,\n      db_id: dbId,\n      schema,\n      sql,\n      extra_json: _JSON$stringify({ schedule_info: formData }) };\n\n    onSchedule(query);\n    (_saveModal = saveModal) == null ? void 0 : _saveModal.close();\n  };\n  const renderModalBody = () => ___EmotionJSX(Form, { layout: \"vertical\", __self: this, __source: { fileName: _jsxFileName, lineNumber: 102, columnNumber: 36 } },\n  ___EmotionJSX(StyledRow, { __self: this, __source: { fileName: _jsxFileName, lineNumber: 103, columnNumber: 7 } },\n  ___EmotionJSX(Col, { xs: 24, __self: this, __source: { fileName: _jsxFileName, lineNumber: 104, columnNumber: 9 } },\n  ___EmotionJSX(FormItem, { label: t('Label'), __self: this, __source: { fileName: _jsxFileName, lineNumber: 105, columnNumber: 11 } },\n  ___EmotionJSX(Input, { type: \"text\", placeholder: t('Label for your query'), value: label, onChange: (event) => setLabel(event.target.value), __self: this, __source: { fileName: _jsxFileName, lineNumber: 106, columnNumber: 13 } })))),\n\n\n\n  ___EmotionJSX(StyledRow, { __self: this, __source: { fileName: _jsxFileName, lineNumber: 110, columnNumber: 7 } },\n  ___EmotionJSX(Col, { xs: 24, __self: this, __source: { fileName: _jsxFileName, lineNumber: 111, columnNumber: 9 } },\n  ___EmotionJSX(FormItem, { label: t('Description'), __self: this, __source: { fileName: _jsxFileName, lineNumber: 112, columnNumber: 11 } },\n  ___EmotionJSX(TextArea, { rows: 4, placeholder: t('Write a description for your query'), value: description, onChange: (event) => setDescription(event.target.value), __self: this, __source: { fileName: _jsxFileName, lineNumber: 113, columnNumber: 13 } })))),\n\n\n\n  ___EmotionJSX(Row, { __self: this, __source: { fileName: _jsxFileName, lineNumber: 117, columnNumber: 7 } },\n  ___EmotionJSX(Col, { xs: 24, __self: this, __source: { fileName: _jsxFileName, lineNumber: 118, columnNumber: 9 } },\n  ___EmotionJSX(\"div\", { className: \"json-schema\", __self: this, __source: { fileName: _jsxFileName, lineNumber: 119, columnNumber: 11 } },\n  ___EmotionJSX(SchemaForm, { schema: getJSONSchema(), uiSchema: getUISchema, onSubmit: onScheduleSubmit, validate: getValidator(), __self: this, __source: { fileName: _jsxFileName, lineNumber: 120, columnNumber: 13 } },\n  ___EmotionJSX(Button, { buttonStyle: \"primary\", htmlType: \"submit\", css: _ref, __self: this, __source: { fileName: _jsxFileName, lineNumber: 121, columnNumber: 15 } }, \"Submit\"))))),\n\n\n\n\n\n\n  scheduleQueryWarning && ___EmotionJSX(Row, { __self: this, __source: { fileName: _jsxFileName, lineNumber: 128, columnNumber: 33 } },\n  ___EmotionJSX(Col, { xs: 24, __self: this, __source: { fileName: _jsxFileName, lineNumber: 129, columnNumber: 11 } },\n  ___EmotionJSX(\"small\", { __self: this, __source: { fileName: _jsxFileName, lineNumber: 130, columnNumber: 13 } }, scheduleQueryWarning))));\n\n\n\n  return ___EmotionJSX(\"span\", { className: \"ScheduleQueryButton\", __self: this, __source: { fileName: _jsxFileName, lineNumber: 134, columnNumber: 13 } },\n  ___EmotionJSX(ModalTrigger, { ref: (ref) => {\n      saveModal = ref;\n    }, modalTitle: t('Schedule query'), modalBody: renderModalBody(), triggerNode: ___EmotionJSX(StyledButtonComponent, { onClick: () => setShowSchedule(!showSchedule), buttonSize: \"small\", buttonStyle: \"link\", tooltip: tooltip, disabled: disabled, __self: this, __source: { fileName: _jsxFileName, lineNumber: 137, columnNumber: 88 } },\n    t('Schedule')), __self: this, __source: { fileName: _jsxFileName, lineNumber: 135, columnNumber: 7 } }));\n\n\n};__signature__(ScheduleQueryButton, \"useState{[description, setDescription]('')}\\nuseState{[label, setLabel](defaultLabel)}\\nuseState{[showSchedule, setShowSchedule](false)}\");const _default =\nScheduleQueryButton;export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(validators, \"validators\", \"/Users/frankhe/projects/superset/superset-frontend/src/SqlLab/components/ScheduleQueryButton.tsx\");reactHotLoader.register(getJSONSchema, \"getJSONSchema\", \"/Users/frankhe/projects/superset/superset-frontend/src/SqlLab/components/ScheduleQueryButton.tsx\");reactHotLoader.register(getUISchema, \"getUISchema\", \"/Users/frankhe/projects/superset/superset-frontend/src/SqlLab/components/ScheduleQueryButton.tsx\");reactHotLoader.register(getValidationRules, \"getValidationRules\", \"/Users/frankhe/projects/superset/superset-frontend/src/SqlLab/components/ScheduleQueryButton.tsx\");reactHotLoader.register(getValidator, \"getValidator\", \"/Users/frankhe/projects/superset/superset-frontend/src/SqlLab/components/ScheduleQueryButton.tsx\");reactHotLoader.register(StyledRow, \"StyledRow\", \"/Users/frankhe/projects/superset/superset-frontend/src/SqlLab/components/ScheduleQueryButton.tsx\");reactHotLoader.register(StyledButtonComponent, \"StyledButtonComponent\", \"/Users/frankhe/projects/superset/superset-frontend/src/SqlLab/components/ScheduleQueryButton.tsx\");reactHotLoader.register(ScheduleQueryButton, \"ScheduleQueryButton\", \"/Users/frankhe/projects/superset/superset-frontend/src/SqlLab/components/ScheduleQueryButton.tsx\");reactHotLoader.register(_default, \"default\", \"/Users/frankhe/projects/superset/superset-frontend/src/SqlLab/components/ScheduleQueryButton.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"sources":["/Users/frankhe/projects/superset/superset-frontend/src/SqlLab/components/ScheduleQueryButton.tsx"],"names":[],"mappings":"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","sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { FunctionComponent, useState } from 'react';\nimport SchemaForm, { FormProps, FormValidation } from 'react-jsonschema-form';\nimport { Row, Col, Input, TextArea } from 'src/common/components';\nimport { t, styled } from '@superset-ui/core';\nimport * as chrono from 'chrono-node';\nimport ModalTrigger from 'src/components/ModalTrigger';\nimport { Form, FormItem } from 'src/components/Form';\nimport './ScheduleQueryButton.less';\nimport Button from 'src/components/Button';\n\nconst validators = {\n  greater: (a: number, b: number) => a > b,\n  greater_equal: (a: number, b: number) => a >= b,\n  less: (a: number, b: number) => a < b,\n  less_equal: (a: number, b: number) => a <= b,\n};\n\nconst getJSONSchema = () => {\n  const jsonSchema = window.featureFlags.SCHEDULED_QUERIES?.JSONSCHEMA;\n  // parse date-time into usable value (eg, 'today' => `new Date()`)\n  if (jsonSchema) {\n    Object.entries(jsonSchema.properties).forEach(\n      ([key, value]: [string, any]) => {\n        if (value.default && value.format === 'date-time') {\n          jsonSchema.properties[key] = {\n            ...value,\n            default: chrono.parseDate(value.default).toISOString(),\n          };\n        }\n      },\n    );\n    return jsonSchema;\n  }\n  return {};\n};\n\nconst getUISchema = () => window.featureFlags.SCHEDULED_QUERIES?.UISCHEMA;\n\nconst getValidationRules = () =>\n  window.featureFlags.SCHEDULED_QUERIES?.VALIDATION || [];\n\nconst getValidator = () => {\n  const rules: any = getValidationRules();\n  return (formData: Record<string, any>, errors: FormValidation) => {\n    rules.forEach((rule: any) => {\n      const test = validators[rule.name];\n      const args = rule.arguments.map((name: string) => formData[name]);\n      const container = rule.container || rule.arguments.slice(-1)[0];\n      if (!test(...args)) {\n        errors[container].addError(rule.message);\n      }\n    });\n    return errors;\n  };\n};\n\ninterface ScheduleQueryButtonProps {\n  defaultLabel?: string;\n  sql: string;\n  schema?: string;\n  dbId: number;\n  animation?: boolean;\n  onSchedule?: Function;\n  scheduleQueryWarning: string | null;\n  disabled: boolean;\n  tooltip: string;\n}\n\nconst StyledRow = styled(Row)`\n  padding-bottom: ${({ theme }) => theme.gridUnit * 2}px;\n`;\n\nexport const StyledButtonComponent = styled(Button)`\n  background: none;\n  text-transform: none;\n  padding: 0px;\n  color: rgba(0, 0, 0, 0.85);\n  font-size: 14px;\n  font-weight: ${({ theme }) => theme.typography.weights.normal};\n  &:disabled {\n    background: none;\n    color: rgba(0, 0, 0, 0.85);\n    &:hover {\n      background: none;\n      color: rgba(0, 0, 0, 0.85);\n    }\n  }\n`;\n\nconst ScheduleQueryButton: FunctionComponent<ScheduleQueryButtonProps> = ({\n  defaultLabel = t('Undefined'),\n  sql,\n  schema,\n  dbId,\n  onSchedule = () => {},\n  scheduleQueryWarning,\n  tooltip,\n  disabled = false,\n}) => {\n  const [description, setDescription] = useState('');\n  const [label, setLabel] = useState(defaultLabel);\n  const [showSchedule, setShowSchedule] = useState(false);\n  let saveModal: ModalTrigger | null;\n\n  const onScheduleSubmit = ({\n    formData,\n  }: {\n    formData: Omit<FormProps<Record<string, any>>, 'schema'>;\n  }) => {\n    const query = {\n      label,\n      description,\n      db_id: dbId,\n      schema,\n      sql,\n      extra_json: JSON.stringify({ schedule_info: formData }),\n    };\n    onSchedule(query);\n    saveModal?.close();\n  };\n\n  const renderModalBody = () => (\n    <Form layout=\"vertical\">\n      <StyledRow>\n        <Col xs={24}>\n          <FormItem label={t('Label')}>\n            <Input\n              type=\"text\"\n              placeholder={t('Label for your query')}\n              value={label}\n              onChange={(event: React.ChangeEvent<HTMLInputElement>) =>\n                setLabel(event.target.value)\n              }\n            />\n          </FormItem>\n        </Col>\n      </StyledRow>\n      <StyledRow>\n        <Col xs={24}>\n          <FormItem label={t('Description')}>\n            <TextArea\n              rows={4}\n              placeholder={t('Write a description for your query')}\n              value={description}\n              onChange={(event: React.ChangeEvent<HTMLTextAreaElement>) =>\n                setDescription(event.target.value)\n              }\n            />\n          </FormItem>\n        </Col>\n      </StyledRow>\n      <Row>\n        <Col xs={24}>\n          <div className=\"json-schema\">\n            <SchemaForm\n              schema={getJSONSchema()}\n              uiSchema={getUISchema}\n              onSubmit={onScheduleSubmit}\n              validate={getValidator()}\n            >\n              <Button\n                buttonStyle=\"primary\"\n                htmlType=\"submit\"\n                css={{ float: 'right' }}\n              >\n                Submit\n              </Button>\n            </SchemaForm>\n          </div>\n        </Col>\n      </Row>\n      {scheduleQueryWarning && (\n        <Row>\n          <Col xs={24}>\n            <small>{scheduleQueryWarning}</small>\n          </Col>\n        </Row>\n      )}\n    </Form>\n  );\n\n  return (\n    <span className=\"ScheduleQueryButton\">\n      <ModalTrigger\n        ref={ref => {\n          saveModal = ref;\n        }}\n        modalTitle={t('Schedule query')}\n        modalBody={renderModalBody()}\n        triggerNode={\n          <StyledButtonComponent\n            onClick={() => setShowSchedule(!showSchedule)}\n            buttonSize=\"small\"\n            buttonStyle=\"link\"\n            tooltip={tooltip}\n            disabled={disabled}\n          >\n            {t('Schedule')}\n          </StyledButtonComponent>\n        }\n      />\n    </span>\n  );\n};\n\nexport default ScheduleQueryButton;\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}