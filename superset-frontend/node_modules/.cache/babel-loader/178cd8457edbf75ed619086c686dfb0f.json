{"ast":null,"code":"import \"core-js/modules/web.dom-collections.iterator.js\";import _filterInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/filter\";import _includesInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/includes\";import _indexOfInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/index-of\";import _sortInstanceProperty from \"@babel/runtime-corejs3/core-js-stable/instance/sort\";import _uniqWith from \"lodash/uniqWith\";var _jsxFileName = \"/Users/frankhe/projects/superset/superset-frontend/src/dashboard/components/FiltersBadge/index.tsx\";(function () {var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;enterModule && enterModule(module);})();var __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {return a;}; /**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\n\nimport cx from 'classnames';\nimport Icons from 'src/components/Icons';\nimport { usePrevious } from 'src/common/hooks/usePrevious';\nimport DetailsPanelPopover from './DetailsPanel';\nimport { Pill } from './Styles';\nimport { IndicatorStatus, selectIndicatorsForChart, selectNativeIndicatorsForChart } from './selectors';\nimport { setDirectPathToChild } from '../../actions/dashboardState';import { jsx as ___EmotionJSX } from \"@emotion/react\";\nconst sortByStatus = (indicators) => {\n  const statuses = [\n  IndicatorStatus.Applied,\n  IndicatorStatus.Unset,\n  IndicatorStatus.Incompatible];\n\n  return _sortInstanceProperty(indicators).call(indicators, (a, b) => _indexOfInstanceProperty(statuses).call(statuses, a.status) -\n  _indexOfInstanceProperty(statuses).call(statuses, b.status));\n};\nexport const FiltersBadge = ({ chartId }) => {var _dashboardInfo$metada2;\n  const dispatch = useDispatch();\n  const datasources = useSelector((state) => state.datasources);\n  const dashboardFilters = useSelector((state) => state.dashboardFilters);\n  const nativeFilters = useSelector((state) => {var _state$nativeFilters;return (_state$nativeFilters = state.nativeFilters) == null ? void 0 : _state$nativeFilters.filters;});\n  const dashboardInfo = useSelector((state) => state.dashboardInfo);\n  const charts = useSelector((state) => state.charts);\n  const present = useSelector((state) => state.dashboardLayout.present);\n  const dataMask = useSelector((state) => state.dataMask);\n  const [nativeIndicators, setNativeIndicators] = useState([]);\n  const [dashboardIndicators, setDashboardIndicators] = useState([]);\n  const onHighlightFilterSource = useCallback((path) => {\n    dispatch(setDirectPathToChild(path));\n  }, [dispatch]);\n  const chart = charts[chartId];\n  const prevChartStatus = usePrevious(chart == null ? void 0 : chart.chartStatus);\n  const showIndicators = useCallback(() => {var _context;return (chart == null ? void 0 : chart.chartStatus) && _includesInstanceProperty(_context = ['rendered', 'success']).call(_context, chart.chartStatus);}, [chart.chartStatus]);\n  useEffect(() => {\n    if (!showIndicators) {\n      setDashboardIndicators([]);\n    }\n    if (prevChartStatus !== 'success') {\n      setDashboardIndicators(selectIndicatorsForChart(chartId, dashboardFilters, datasources, chart));\n    }\n  }, [\n  chart,\n  chartId,\n  dashboardFilters,\n  datasources,\n  prevChartStatus,\n  showIndicators]);\n\n  useEffect(() => {\n    if (!showIndicators) {\n      setNativeIndicators([]);\n    }\n    if (prevChartStatus !== 'success') {var _dashboardInfo$metada;\n      setNativeIndicators(selectNativeIndicatorsForChart(nativeFilters, dataMask, chartId, chart, present, (_dashboardInfo$metada = dashboardInfo.metadata) == null ? void 0 : _dashboardInfo$metada.chart_configuration));\n    }\n  }, [\n  chart,\n  chartId, (_dashboardInfo$metada2 =\n  dashboardInfo.metadata) == null ? void 0 : _dashboardInfo$metada2.chart_configuration,\n  dataMask,\n  nativeFilters,\n  present,\n  prevChartStatus,\n  showIndicators]);\n\n  const indicators = useMemo(() => _uniqWith(sortByStatus([...dashboardIndicators, ...nativeIndicators]), (ind1, ind2) => ind1.column === ind2.column &&\n  ind1.name === ind2.name && (\n  ind1.status !== IndicatorStatus.Applied ||\n  ind2.status !== IndicatorStatus.Applied)), [dashboardIndicators, nativeIndicators]);\n  const appliedCrossFilterIndicators = _filterInstanceProperty(indicators).call(indicators, (indicator) => indicator.status === IndicatorStatus.CrossFilterApplied);\n  const appliedIndicators = _filterInstanceProperty(indicators).call(indicators, (indicator) => indicator.status === IndicatorStatus.Applied);\n  const unsetIndicators = _filterInstanceProperty(indicators).call(indicators, (indicator) => indicator.status === IndicatorStatus.Unset);\n  const incompatibleIndicators = _filterInstanceProperty(indicators).call(indicators, (indicator) => indicator.status === IndicatorStatus.Incompatible);\n  if (!appliedCrossFilterIndicators.length &&\n  !appliedIndicators.length &&\n  !incompatibleIndicators.length &&\n  !unsetIndicators.length) {\n    return null;\n  }\n  const isInactive = !appliedCrossFilterIndicators.length &&\n  !appliedIndicators.length &&\n  !incompatibleIndicators.length;\n  return ___EmotionJSX(DetailsPanelPopover, { appliedCrossFilterIndicators: appliedCrossFilterIndicators, appliedIndicators: appliedIndicators, unsetIndicators: unsetIndicators, incompatibleIndicators: incompatibleIndicators, onHighlightFilterSource: onHighlightFilterSource, __self: this, __source: { fileName: _jsxFileName, lineNumber: 104, columnNumber: 13 } },\n  ___EmotionJSX(Pill, { className: cx('filter-counts', !!incompatibleIndicators.length && 'has-incompatible-filters', !!appliedCrossFilterIndicators.length && 'has-cross-filters', isInactive && 'filters-inactive'), __self: this, __source: { fileName: _jsxFileName, lineNumber: 105, columnNumber: 7 } },\n  ___EmotionJSX(Icons.Filter, { iconSize: \"m\", __self: this, __source: { fileName: _jsxFileName, lineNumber: 106, columnNumber: 9 } }),\n  !isInactive && ___EmotionJSX(\"span\", { \"data-test\": \"applied-filter-count\", __self: this, __source: { fileName: _jsxFileName, lineNumber: 107, columnNumber: 26 } },\n  appliedIndicators.length + appliedCrossFilterIndicators.length),\n\n  incompatibleIndicators.length ? ___EmotionJSX(React.Fragment, null,\n  ' ',\n  ___EmotionJSX(Icons.AlertSolid, { __self: this, __source: { fileName: _jsxFileName, lineNumber: 112, columnNumber: 13 } }),\n  ___EmotionJSX(\"span\", { \"data-test\": \"incompatible-filter-count\", __self: this, __source: { fileName: _jsxFileName, lineNumber: 113, columnNumber: 13 } },\n  incompatibleIndicators.length)) :\n\n  null));\n\n\n};__signature__(FiltersBadge, \"useDispatch{dispatch}\\nuseSelector{datasources}\\nuseSelector{dashboardFilters}\\nuseSelector{nativeFilters}\\nuseSelector{dashboardInfo}\\nuseSelector{charts}\\nuseSelector{present}\\nuseSelector{dataMask}\\nuseState{[nativeIndicators, setNativeIndicators]([])}\\nuseState{[dashboardIndicators, setDashboardIndicators]([])}\\nuseCallback{onHighlightFilterSource}\\nusePrevious{prevChartStatus}\\nuseCallback{showIndicators}\\nuseEffect{}\\nuseEffect{}\\nuseMemo{indicators}\", () => [useDispatch, useSelector, useSelector, useSelector, useSelector, useSelector, useSelector, useSelector, usePrevious]);const _default = /*#__PURE__*/\nReact.memo(FiltersBadge);export default _default;;(function () {var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;if (!reactHotLoader) {return;}reactHotLoader.register(sortByStatus, \"sortByStatus\", \"/Users/frankhe/projects/superset/superset-frontend/src/dashboard/components/FiltersBadge/index.tsx\");reactHotLoader.register(FiltersBadge, \"FiltersBadge\", \"/Users/frankhe/projects/superset/superset-frontend/src/dashboard/components/FiltersBadge/index.tsx\");reactHotLoader.register(_default, \"default\", \"/Users/frankhe/projects/superset/superset-frontend/src/dashboard/components/FiltersBadge/index.tsx\");})();;(function () {var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;leaveModule && leaveModule(module);})();","map":{"version":3,"sources":["/Users/frankhe/projects/superset/superset-frontend/src/dashboard/components/FiltersBadge/index.tsx"],"names":[],"mappings":"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","sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { uniqWith } from 'lodash';\nimport cx from 'classnames';\nimport Icons from 'src/components/Icons';\nimport { usePrevious } from 'src/common/hooks/usePrevious';\nimport { DataMaskStateWithId } from 'src/dataMask/types';\nimport DetailsPanelPopover from './DetailsPanel';\nimport { Pill } from './Styles';\nimport {\n  Indicator,\n  IndicatorStatus,\n  selectIndicatorsForChart,\n  selectNativeIndicatorsForChart,\n} from './selectors';\nimport { setDirectPathToChild } from '../../actions/dashboardState';\nimport {\n  ChartsState,\n  DashboardInfo,\n  DashboardLayout,\n  RootState,\n} from '../../types';\nimport { Filters } from '../../reducers/types';\n\nexport interface FiltersBadgeProps {\n  chartId: number;\n}\n\nconst sortByStatus = (indicators: Indicator[]): Indicator[] => {\n  const statuses = [\n    IndicatorStatus.Applied,\n    IndicatorStatus.Unset,\n    IndicatorStatus.Incompatible,\n  ];\n  return indicators.sort(\n    (a, b) =>\n      statuses.indexOf(a.status as IndicatorStatus) -\n      statuses.indexOf(b.status as IndicatorStatus),\n  );\n};\n\nexport const FiltersBadge = ({ chartId }: FiltersBadgeProps) => {\n  const dispatch = useDispatch();\n  const datasources = useSelector<RootState, any>(state => state.datasources);\n  const dashboardFilters = useSelector<RootState, any>(\n    state => state.dashboardFilters,\n  );\n  const nativeFilters = useSelector<RootState, Filters>(\n    state => state.nativeFilters?.filters,\n  );\n  const dashboardInfo = useSelector<RootState, DashboardInfo>(\n    state => state.dashboardInfo,\n  );\n  const charts = useSelector<RootState, ChartsState>(state => state.charts);\n  const present = useSelector<RootState, DashboardLayout>(\n    state => state.dashboardLayout.present,\n  );\n  const dataMask = useSelector<RootState, DataMaskStateWithId>(\n    state => state.dataMask,\n  );\n\n  const [nativeIndicators, setNativeIndicators] = useState<Indicator[]>([]);\n  const [dashboardIndicators, setDashboardIndicators] = useState<Indicator[]>(\n    [],\n  );\n\n  const onHighlightFilterSource = useCallback(\n    (path: string[]) => {\n      dispatch(setDirectPathToChild(path));\n    },\n    [dispatch],\n  );\n\n  const chart = charts[chartId];\n  const prevChartStatus = usePrevious(chart?.chartStatus);\n\n  const showIndicators = useCallback(\n    () =>\n      chart?.chartStatus && ['rendered', 'success'].includes(chart.chartStatus),\n    [chart.chartStatus],\n  );\n  useEffect(() => {\n    if (!showIndicators) {\n      setDashboardIndicators([]);\n    }\n    if (prevChartStatus !== 'success') {\n      setDashboardIndicators(\n        selectIndicatorsForChart(chartId, dashboardFilters, datasources, chart),\n      );\n    }\n  }, [\n    chart,\n    chartId,\n    dashboardFilters,\n    datasources,\n    prevChartStatus,\n    showIndicators,\n  ]);\n\n  useEffect(() => {\n    if (!showIndicators) {\n      setNativeIndicators([]);\n    }\n    if (prevChartStatus !== 'success') {\n      setNativeIndicators(\n        selectNativeIndicatorsForChart(\n          nativeFilters,\n          dataMask,\n          chartId,\n          chart,\n          present,\n          dashboardInfo.metadata?.chart_configuration,\n        ),\n      );\n    }\n  }, [\n    chart,\n    chartId,\n    dashboardInfo.metadata?.chart_configuration,\n    dataMask,\n    nativeFilters,\n    present,\n    prevChartStatus,\n    showIndicators,\n  ]);\n\n  const indicators = useMemo(\n    () =>\n      uniqWith(\n        sortByStatus([...dashboardIndicators, ...nativeIndicators]),\n        (ind1, ind2) =>\n          ind1.column === ind2.column &&\n          ind1.name === ind2.name &&\n          (ind1.status !== IndicatorStatus.Applied ||\n            ind2.status !== IndicatorStatus.Applied),\n      ),\n    [dashboardIndicators, nativeIndicators],\n  );\n\n  const appliedCrossFilterIndicators = indicators.filter(\n    indicator => indicator.status === IndicatorStatus.CrossFilterApplied,\n  );\n  const appliedIndicators = indicators.filter(\n    indicator => indicator.status === IndicatorStatus.Applied,\n  );\n  const unsetIndicators = indicators.filter(\n    indicator => indicator.status === IndicatorStatus.Unset,\n  );\n  const incompatibleIndicators = indicators.filter(\n    indicator => indicator.status === IndicatorStatus.Incompatible,\n  );\n\n  if (\n    !appliedCrossFilterIndicators.length &&\n    !appliedIndicators.length &&\n    !incompatibleIndicators.length &&\n    !unsetIndicators.length\n  ) {\n    return null;\n  }\n\n  const isInactive =\n    !appliedCrossFilterIndicators.length &&\n    !appliedIndicators.length &&\n    !incompatibleIndicators.length;\n\n  return (\n    <DetailsPanelPopover\n      appliedCrossFilterIndicators={appliedCrossFilterIndicators}\n      appliedIndicators={appliedIndicators}\n      unsetIndicators={unsetIndicators}\n      incompatibleIndicators={incompatibleIndicators}\n      onHighlightFilterSource={onHighlightFilterSource}\n    >\n      <Pill\n        className={cx(\n          'filter-counts',\n          !!incompatibleIndicators.length && 'has-incompatible-filters',\n          !!appliedCrossFilterIndicators.length && 'has-cross-filters',\n          isInactive && 'filters-inactive',\n        )}\n      >\n        <Icons.Filter iconSize=\"m\" />\n        {!isInactive && (\n          <span data-test=\"applied-filter-count\">\n            {appliedIndicators.length + appliedCrossFilterIndicators.length}\n          </span>\n        )}\n        {incompatibleIndicators.length ? (\n          <>\n            {' '}\n            <Icons.AlertSolid />\n            <span data-test=\"incompatible-filter-count\">\n              {incompatibleIndicators.length}\n            </span>\n          </>\n        ) : null}\n      </Pill>\n    </DetailsPanelPopover>\n  );\n};\n\nexport default React.memo(FiltersBadge);\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}